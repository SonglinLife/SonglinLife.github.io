<!-- build time:Mon Mar 14 2022 11:43:21 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Life" href="https://songlinlife.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="Life" href="https://songlinlife.top/atom.xml"><link rel="alternate" type="application/json" title="Life" href="https://songlinlife.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="MIT6.824"><link rel="canonical" href="https://songlinlife.top/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-lab3-KV-Service/"><title>MIT6.824: lab3 KV Service - åˆ†å¸ƒå¼ | Songlin = Life</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">MIT6.824: lab3 KV Service</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2022-03-07 13:51:07"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2022-03-07T13:51:07+08:00">2022-03-07</time> </span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">æœ¬æ–‡å­—æ•°</span> <span>3.1k</span> <span class="text">å­—</span> </span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">é˜…è¯»æ—¶é•¿</span> <span>3 åˆ†é’Ÿ</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Songlin</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipevo9j1jj20zk0m8e81.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclwrdwyaj20zk0m8are.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclflwv2aj20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclfw2t96j20zk0m8x6p.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipewkhf1zj20zk0m81kx.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicitzannuj20zk0m8b29.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" itemprop="item" rel="index" title="åˆ†ç±»äº åˆ†å¸ƒå¼"><span itemprop="name">åˆ†å¸ƒå¼</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://songlinlife.top/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-lab3-KV-Service/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Kalice"><meta itemprop="description" content=", Life is not about lifestyle, it means Lithium and Ferrum."></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Life"></span><div class="body md" itemprop="articleBody"><p>ç»ˆäºåˆ°äº† Lab3 äº†ï¼Œå†™ä¸€ä¸ª KV æœåŠ¡ğŸ</p><h3 id="è¦æ±‚"><a class="anchor" href="#è¦æ±‚">#</a> è¦æ±‚</h3><p>lab3 éœ€è¦æ„å»ºä¸€ä¸ª fault-tolerance key/value storage serviceã€‚ç”¨åˆ°ä¹‹å‰ lab2 å†™çš„ Raft libraryã€‚</p><ol><li><p>ä¸‰ä¸ª api æ¥å£ï¼š <code>Put(key, value)</code> , <code>Append(key, arg)</code> , and <code>Get(key)</code> ã€‚å¦‚æœ key ä¸å­˜åœ¨ï¼Œ <code>Get(key)</code> è¿”å›ç©º stringï¼Œå¹¶ä¸” <code>append</code> ä¸ <code>put</code> æ“ä½œç­‰ä»·ã€‚</p></li><li><p>each client talks to the service through a <code>Clerk</code> with Put/Append/Get methods.</p></li><li><p>å®ç°å¼ºä¸€è‡´æ€§ã€‚</p></li><li><p>è¾¾æˆæ•ˆæœ</p></li><li><p><img data-src="https://image-2021-wu.oss-cn-beijing.aliyuncs.com/blogs/picturesimage-20220309191901863.png" alt="image-20220309191901863"></p></li></ol><h3 id="part-a"><a class="anchor" href="#part-a">#</a> Part A</h3><p>æ¯ä¸€ä¸ª kv server éƒ½å…³è”äº†ä¸€ä¸ª raft peerã€‚</p><p>å®ç° <code>Put</code> ã€ <code>Append</code> ã€ <code>Get</code> ã€‚kvserver å…ˆ raft æäº¤è¿™ä¸‰ä¸ª operationï¼Œraft log å†™è¿™ä¸‰ä¸ªæ“ä½œçš„åºåˆ—ã€‚</p><p>kv server ç”± raft å†³å®šåº”è¯¥æ‰§è¡Œä»€ä¹ˆ operationã€‚</p><p><code>Clerk</code> å¹¶ä¸çŸ¥é“è°æ˜¯ leaderï¼Œå› æ­¤å¦‚æœ Clerk å‘é€ RPC åˆ°é”™çš„ kvserverï¼Œæˆ–è€…ä¸èƒ½åˆ°è¾¾è¿™ä¸ª kvserverï¼Œé‚£ä¹ˆ Clerk éœ€è¦é‡æ–°å‘é€åˆ°å¦ä¸€ä¸ª kvserverã€‚</p><p>å¦‚æœè¿™ä¸ªå‘½ä»¤ commit ä¹‹åï¼Œé‚£ä¹ˆ raft ä¼š apply commandï¼Œäº server ä¼šå…ˆæ‰§è¡Œçš„ç»“æœè¿”å›ç»™ Clerkã€‚</p><p>å¦‚æœ operation æ²¡æœ‰è¢« commitï¼Œé‚£ä¹ˆ server å‘é€ä¸€ä¸ª errorï¼Œç„¶å <code>Clerk</code> éœ€è¦é‡è¯•ã€‚</p><h4 id="æˆ‘çš„æ€è€ƒ"><a class="anchor" href="#æˆ‘çš„æ€è€ƒ">#</a> æˆ‘çš„æ€è€ƒ</h4><p>client é€šè¿‡ clerk å‘é€ä¸‰ç§ operationï¼Œè¿™ä¸‰ç§ operation åªèƒ½è¢« leader æ¥æ‰§è¡Œã€‚åªè¦æ˜¯ leader apply çš„ operation ä¸€å®šæ˜¯ commitï¼Œè¿™æ¯«æ— ç–‘é—®ã€‚ç°åœ¨çš„é—®é¢˜æ˜¯å¦‚ä½•è®© kvserver æ¥æ£€æŸ¥è¿™ä¸ªæ“ä½œæ˜¯æ‰§è¡Œçš„å‘¢ï¼Ÿ</p><p>Put å’Œ Append æ“ä½œåªèƒ½è¢«æ‰§è¡Œä¸€æ¬¡ä¸èƒ½è¢«å¤šæ¬¡æ‰§è¡Œï¼Œè¿™ä¸€ç‚¹éœ€è¦æ³¨æ„ã€‚</p><p>å¯¹äº commandï¼Œéœ€è¦è®¾è®¡ä¸€ä¸ªæ ¼å¼ï¼Œèƒ½å¤Ÿè®© kvserver çŸ¥é“ operation æ˜¯ä»€ä¹ˆã€‚å› ä¸º command å°±æ˜¯ä¸€ä¸ª stringã€‚</p><p>æŒ‰ç…§è¦æ±‚ä¹Ÿå°±æ˜¯è¯´ client å¦‚æœæ²¡æœ‰æ‰§è¡ŒæˆåŠŸæŸä¸ª operation å°±ä¼šä¸€ç›´è¢«é˜»å¡ã€‚</p><p>æˆ‘å…³äº PutAppend çš„è€ƒè™‘ï¼Œå› ä¸ºæ“ä½œéœ€è¦å»é™¤é‡å¤ï¼Œå› ä¸º client éœ€è¦å¹¶å‘ã€‚æ‰€ä»¥ä¸èƒ½</p><h3 id="raftå®ç°çº¿æ€§ä¸€è‡´æ€§"><a class="anchor" href="#raftå®ç°çº¿æ€§ä¸€è‡´æ€§">#</a> Raft å®ç°çº¿æ€§ä¸€è‡´æ€§</h3><p>å¤šç”¨æˆ·å¹¶å‘ï¼ˆæ¯ä¸ª client åªæ˜¯è°ƒç”¨ä¸€ä¸ªè¯·æ±‚ï¼‰</p><blockquote><p>It's OK to assume that a client will make only one call into a Clerk at a time.</p></blockquote><p>æå‡ä¸­ä¹Ÿè¯´äº†ï¼Œå¯ä»¥å‡è®¾ client æ¯ä¸€æ¬¡åªæ˜¯ call ä¸€æ¬¡ã€‚</p><blockquote><p>it's OK in this case for the server and client to wait indefinitely until the partition heals.</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´å¯ä»¥è®©è¿™ä¸ª wait æ— é™åˆ¶ç­‰ä¸‹å»ã€‚ï¼ˆç­‰ commit å¯ä»¥ä¸é™æ—¶é—´ï¼‰</p><p>ä½†æ˜¯æˆ‘ä»¬èƒ½ä¸èƒ½æ“ä½œä¸€ä¸‹ï¼Ÿæä¸€ä¸ªè¶…æ—¶ï¼Ÿ</p><p>æˆ‘æ²¡å¤´ç»ªçš„æ—¶å€™ï¼Œçœ‹åˆ°äº† Raft åšå£«è®ºæ–‡ï¼ŒçœŸçš„æ„ŸåŠ¨å•Šã€‚</p><p><img data-src="https://image-2021-wu.oss-cn-beijing.aliyuncs.com/blogs/picturespicturesimage-20220307222045412.png" alt="image-20220307222045412"></p><p>æŒ‰ç…§è¿™ä¸ªå‚æ•°å†™ RPC å°±è¡Œäº†ã€‚</p><h4 id="å»é‡å¤"><a class="anchor" href="#å»é‡å¤">#</a> å»é‡å¤</h4><p>æˆ‘ä»¬å‡å®šæ¯ä¸€ä¸ª client æ¯ä¸€æ¬¡åªæ˜¯æ‰§è¡Œï¼ˆcallï¼‰ä¸€ä¸ªæ“ä½œï¼Œå¹¶ä¸”å¦‚æœæ‰§è¡Œå¤±è´¥çš„è¯ï¼Œé‚£ä¹ˆå®ƒä¼šé˜»å¡ä½ï¼Œå¹¶ä¸”ä¸€ç›´æ‰§è¡Œè¿™ä¸ªè¯·æ±‚ã€‚</p><p>è¿™æ ·å»é‡å¤å°±å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ server ç«¯ç»´æŠ¤ä¸€ä¸ª lastComandID å°±è¡Œäº†ï¼Œæ•°æ®ç»“æ„ä¸º map []</p><h3 id="39å·æ›´æ–°"><a class="anchor" href="#39å·æ›´æ–°">#</a> 3.9 å·æ›´æ–°</h3><p>æœ€è¿‘ä¸€ä¸ªéå¸¸ä¸¥é‡çš„ bug å¡äº†æˆ‘ä¸€å¤©ï¼Œæ€ä¹ˆéƒ½æ²¡åŠæ³•å¤„ç†å¥½ã€‚æ˜¯å…³äºçº¿æ€§ä¸€è‡´æ€§çš„ï¼Œæˆ‘ä¸€ç›´æ²¡æœ‰æ€ä¹ˆç†è§£çº¿æ€§ä¸€è‡´æ€§è¿™å°±å¯¼è‡´æˆ‘è¿™ä¸ª lab åšå¾—å¾ˆç—›è‹¦ã€‚</p><p>å…ˆçœ‹ä¸€ä¸‹ raft ä½œè€…å¯¹çº¿æ€§ä¸€è‡´æ€§çš„ç†è§£ï¼š</p><blockquote><p>In linearizability, each operation appears to execute instantaneously, exactly once, at some point between its invocation and its response. This is a strong form of consistency that is simple for clients to reason about, and it disallows commands being processed multiple times.</p></blockquote><p>æ³¨æ„è¿™ä¸ª exactly onceï¼Œ at some pointã€‚ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰æ“ä½œéƒ½åªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ä¸”æ˜¯åŸå­æ€§ç¬æ—¶çš„ã€‚è¿™ä¼¼ä¹æœ‰äº›å¥‡æ€ªï¼Œå› ä¸ºæˆ‘ä»¬æ˜æ˜å¯ä»¥æ‰§è¡Œå¤šæ¬¡çš„ï¼Œå› ä¸ºå½“æœ‰è¯·æ±‚åˆ° kv server æ—¶å€™æˆ‘ä»¬å°±è¿›è¡Œäº†ä¸€æ¬¡å†™ raft logï¼Œç„¶åå› ä¸ºè¶…æ—¶åŸå› æˆ‘ä»¬åˆä¸€æ¬¡å‘ raft å‘é€äº†è¯·æ±‚ï¼Œæœ‰ä¸€æ¬¡å†™äº†ä¸€æ¬¡ raft logã€‚æ‰€ä»¥åœ¨ apply é˜¶æ®µï¼Œä¸ºäº†å®ç°è¿™ä¸ª exactly once æˆ‘ä»¬éœ€è¦å¯¹æ“ä½œè¿›è¡Œå»é‡å¤ï¼Œä¿è¯æ‰€æœ‰æ“ä½œåªèƒ½æ‰§è¡Œä¸€æ¬¡ã€‚</p><p>ä½†æ˜¯é—®é¢˜è¿˜æ²¡ç»“æŸï¼Œå»é‡çœŸçš„ä¿è¯äº†çº¿æ€§ä¸€è‡´æ€§å—ï¼Ÿæ³¨æ„ä½œè€…è¿™å¥è¯ï¼š<strong>at some point between its invocation and its response. ** between its invocation and its response. æ˜¯å…³é”®æ‰€åœ¨ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„æ‰§è¡Œæ˜¯è¦å‘ç”Ÿåœ¨è°ƒç”¨å’Œè¿”å›ä¹‹é—´çš„ã€‚ä½†æ˜¯åœ¨ä¸Šé¢çš„æè¿°ä¸­ï¼Œæˆ‘ä»¬æ˜¯æ€ä¹ˆæ“ä½œçš„ï¼Ÿå¦‚æœå½“è¶…æ—¶å°±</strong>é‡æ–°å‘é€è¯·æ±‚ **ã€‚è¿™æ„å‘³ç€é‚£ä¸ªè¶…æ—¶çš„è¯·æ±‚å·²ç»ç»“æŸäº†ï¼Œå®ƒæ²¡æœ‰åœ¨è°ƒç”¨å’Œè¿”å›ä¹‹é—´æ‰§è¡Œï¼</p><p>æ¥çœ‹ä¸‹é¢è¿™ä¸ªåœºæ™¯ï¼š</p><p><img data-src="https://image-2021-wu.oss-cn-beijing.aliyuncs.com/blogs/picturesimage-20220309100623892.png" alt="image-20220309100623892"></p><p>è¿™é‡Œæœ‰ä¸‰ä¸ª clientï¼Œå¹¶å‘å‘é€è¯·æ±‚ã€‚ç°åœ¨æˆ‘ä»¬æŠŠé—®é¢˜ç®€å•åŒ–ï¼Œåªæ˜¯å¯¹ log ä¸­çš„ä¸€ä¸ªå˜é‡ x è¿›è¡Œè€ƒè™‘ï¼Œå®ƒåˆå§‹ä¸ºç©ºï¼ŒA1 è¡¨ç¤ºå‘ x Append 1ã€‚R è¡¨ç¤ºè¯»è¿™ä¸ªå˜é‡ xã€‚</p><p>æ³¨æ„ï¼è¿™é‡Œæˆ‘çš„çº¿æ®µè¡¨ç¤º client<strong> å‘èµ·æŸä¸€ä¸ªè¯·æ±‚åˆ°ç»“æŸçš„æ—¶é—´</strong>ï¼Œè¿™æ®µæ—¶é—´å†… client å¯èƒ½å› æ­¤è¶…æ—¶ç­‰åŸå› å¤šæ¬¡å‘é€é‡å¤çš„è¯·æ±‚ï¼ŒçŸ¥é“æœ€ç»ˆæ”¶åˆ°ç­”å¤ã€‚</p><p>å› ä¸º KV server é¦–å…ˆæ‰§è¡Œäº† A1ã€A2ã€‚æ‰€ä»¥è¿™æ—¶å€™ client1 å…ˆè¯»å– xï¼Œå®ƒè¯»åˆ°äº† x çš„å€¼ä¸º 12ã€‚ä½†æ˜¯å› ä¸º rpc è°ƒç”¨ç­‰åŸå› ï¼Œè¿™ä¸ªè¯»å–åˆ°çš„å€¼æ²¡æœ‰è¿”å›ç»™ clientã€‚é‚£ä¹ˆ client è‚¯å®šä¼šé‡æ–°å‘é€è¯»è¯·æ±‚çš„ã€‚ä½†æ˜¯å› ä¸º<strong>å»é‡</strong>ï¼Œæˆ‘ä»¬ä¸èƒ½å†æ‰§è¡Œè¿™ä¸ªè¯»æ“ä½œäº†ï¼Œäºæ˜¯æˆ‘ä»¬æŠŠè¿™ä¸ªè¯»åˆ°çš„ç»“æœå­˜èµ·æ¥ã€‚ç­‰ä¸‹ä¸€æ¬¡ client1 å‘é€è¯»è¯·æ±‚çš„æ—¶å€™ç›´æ¥å‘é€å­˜å¥½çš„ç»“æœã€‚</p><p>okï¼Œclient3 æ­¤æ—¶æ‰§è¡Œäº† A3ï¼Œx çš„å€¼å˜ä¸º 123ï¼Œé‚£ä¹ˆ client2 å†è¯»åå°±è¯»åˆ°äº† 123. å¹¶ä¸”ç›´æ¥è¿”å›ç»™äº† client2ã€‚</p><p>è¿‡äº†ä¸€ä¼šï¼Œclient1 ä¹Ÿè¯»åˆ°äº†ç»“æœï¼Œx å€¼ä¸º 12ã€‚</p><p><strong>äºæ˜¯è¿™å°±æ²¡æœ‰äº†çº¿æ€§ä¸€è‡´æ€§äº†ï¼Œå› ä¸º client1 è¯»åˆ°äº†ä¸€ä¸ªæ—§çš„å€¼ï¼</strong></p><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªæƒ…å†µï¼Œå› ä¸ºæˆ‘ä»¬è¿èƒŒäº†ï¼š</p><p><strong>each operation appears to execute instantaneously, exactly once, at some point between its invocation and its response)</strong></p><p>client çš„è¯»æ“ä½œæŒç»­äº†å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œè€Œä¸æ˜¯ execute instantaneouslyã€‚</p><p>æˆ‘çš„æ€è€ƒå°±æ˜¯ï¼Œè¯»è¯·æ±‚ä¸èƒ½è¿›è¡Œå»é‡ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåªèƒ½åœ¨å½“å‰çš„ KV request å¾—åˆ°å¤„ç†ã€‚</p><h3 id="310å·æ›´æ–°"><a class="anchor" href="#310å·æ›´æ–°">#</a> 3.10 å·æ›´æ–°</h3><p>é‡åˆ°é—®é¢˜ï¼Œ10 æ¬¡æµ‹è¯•é‡Œé¢æ€»æ˜¯ä¼šä¸€æ¬¡æµ‹è¯•è«åå¥‡å¦™ä¸¢å¤± logï¼Œå¯¼è‡´æ•°æ®åœ¨ä¸åŒçš„ kv ä¸ŠåŒæ­¥å¤±è´¥ã€‚ã€‚ã€‚å¾ˆå¤±è´¥ï¼Œæˆ‘æ‰“äº†ä¸€å¤©çš„ debugï¼Œè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°åŸå› ã€‚</p><p>æˆ‘çŸ¥é“é—®é¢˜å‡ºåœ¨æˆ‘çš„ raft å±‚ï¼Œä½†æ˜¯å³ä½¿æˆ‘æŸ¥çœ‹äº†å¾ˆä¹…ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æ‰¾æˆ‘æˆ‘çš„ raft å±‚é—®é¢˜å‡ºåœ¨å“ªé‡Œã€‚ã€‚ã€‚ã€‚</p><ol><li>leader é€‰ä¸¾å¯èƒ½æœ‰ç‚¹é—®é¢˜ï¼Œå¯¼è‡´é€‰ä¸¾äº†ä¸åº”è¯¥æˆä¸º leader çš„èŠ‚ç‚¹ï¼Œè‡´ä½¿è¦†ç›–äº†åç»­çš„æ—¥å¿—ã€‚ä½†æ˜¯è¿™ä¸ªå¯èƒ½æ€§ä¸å¤§</li><li>AppendEntries å‡ºé”™ï¼Œæ²¡æœ‰ commit çš„ log entries è®¤ä¸º committed äº†ï¼Œè¿™å°±å¯¼è‡´åç»­è¿™ä¸ªä¸¢å¤±ã€‚</li></ol><p>é—®é¢˜æ˜¯æˆ‘æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªå¯¼è‡´æ€ä¹ˆæƒ…å†µã€‚ã€‚ã€‚å°±è¿™æ ·å§ï¼Œå¿ƒç´¯äº†ã€‚ã€‚ã€‚</p><p>è€Œä¸” 3B æ˜¯çœŸçš„è¿‡ä¸äº†ï¼Œå¿…é¡»ä»£ç é‡æ„ï¼ŒæŠŠ raft é‡æ–°å†™ä¸€éã€‚ã€‚ã€‚æ„Ÿè§‰å¿ƒå¥½ç´¯å•Šã€‚</p><h3 id="rafté‡æ„"><a class="anchor" href="#rafté‡æ„">#</a> Raft é‡æ„</h3><p>å‚è€ƒä»£ç ï¼š</p><h3 id="312å·æ›´æ–°"><a class="anchor" href="#312å·æ›´æ–°">#</a> 3.12 å·æ›´æ–°</h3><p>æ„‰å¿«æ‰“è¿‡ lab3</p><p><img data-src="https://image-2021-wu.oss-cn-beijing.aliyuncs.com/blogs/picturesimage-20220312193359692.png" alt="image-20220312193359692"></p><div class="tags"><a href="/tags/MIT6-824/" rel="tag"><i class="ic i-tag"></i> MIT6.824</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-03-12 19:34:26" itemprop="dateModified" datetime="2022-03-12T19:34:26+08:00">2022-03-12</time> </span><span id="2022/åˆ†å¸ƒå¼/MIT6-824-lab3-KV-Service/" class="item leancloud_visitors" data-flag-title="MIT6.824: lab3 KV Service" title="é˜…è¯»æ¬¡æ•°"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">é˜…è¯»æ¬¡æ•°</span> <span class="leancloud-visitors-count"></span> <span class="text">æ¬¡</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Kalice å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="/images/alipay.png" alt="Kalice æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>Kalice <i class="ic i-at"><em>@</em></i>Life</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://songlinlife.top/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-lab3-KV-Service/" title="MIT6.824: lab3 KV Service">https://songlinlife.top/2022/åˆ†å¸ƒå¼/MIT6-824-lab3-KV-Service/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-Object-Storage-on-CRAQ-High-throughput-chain-replication-for-read-mostly-workloads/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipeyonbf9j20zk0m8e81.jpg" title="MIT6.824: Object Storage on CRAQ High-throughput chain replication for read-mostly workloads"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> åˆ†å¸ƒå¼</span><h3>MIT6.824: Object Storage on CRAQ High-throughput chain replication for read-mostly workloads</h3></a></div><div class="item right"><a href="/2022/GrimoireLab%EF%BC%9A%E5%A1%AB%E5%9D%91%E8%AE%B0/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicis3attqj20zk0m8k7l.jpg" title="GrimoireLabï¼šå¡«å‘è®°"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> xlab</span><h3>GrimoireLabï¼šå¡«å‘è®°</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A6%81%E6%B1%82"><span class="toc-number">1.</span> <span class="toc-text">è¦æ±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#part-a"><span class="toc-number">2.</span> <span class="toc-text">Part A</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%88%91%E7%9A%84%E6%80%9D%E8%80%83"><span class="toc-number">2.1.</span> <span class="toc-text">æˆ‘çš„æ€è€ƒ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#raft%E5%AE%9E%E7%8E%B0%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7"><span class="toc-number">3.</span> <span class="toc-text">Raft å®ç°çº¿æ€§ä¸€è‡´æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%BB%E9%87%8D%E5%A4%8D"><span class="toc-number">3.1.</span> <span class="toc-text">å»é‡å¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#39%E5%8F%B7%E6%9B%B4%E6%96%B0"><span class="toc-number">4.</span> <span class="toc-text">3.9 å·æ›´æ–°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#310%E5%8F%B7%E6%9B%B4%E6%96%B0"><span class="toc-number">5.</span> <span class="toc-text">3.10 å·æ›´æ–°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#raft%E9%87%8D%E6%9E%84"><span class="toc-number">6.</span> <span class="toc-text">Raft é‡æ„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#312%E5%8F%B7%E6%9B%B4%E6%96%B0"><span class="toc-number">7.</span> <span class="toc-text">3.12 å·æ›´æ–°</span></a></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-mapreduce/" rel="bookmark" title="MIT6.824: mapreduce">MIT6.824: mapreduce</a></li><li><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-GFS/" rel="bookmark" title="MIT6.824: GFS">MIT6.824: GFS</a></li><li><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-The-Design-of-a-Practical-System-for-Fault-Tolerant-Virtual-Machines/" rel="bookmark" title="MIT6.824: The Design of a Practical System for Fault-Tolerant Virtual Machines">MIT6.824: The Design of a Practical System for Fault-Tolerant Virtual Machines</a></li><li><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-lab2-Raft/" rel="bookmark" title="MIT6.824: lab2 Raft">MIT6.824: lab2 Raft</a></li><li><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-zookeeper/" rel="bookmark" title="MIT6.824: ZooKeeper: Wait-free coordination for Internet-scale systems">MIT6.824: ZooKeeper: Wait-free coordination for Internet-scale systems</a></li><li><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-Object-Storage-on-CRAQ-High-throughput-chain-replication-for-read-mostly-workloads/" rel="bookmark" title="MIT6.824: Object Storage on CRAQ High-throughput chain replication for read-mostly workloads">MIT6.824: Object Storage on CRAQ High-throughput chain replication for read-mostly workloads</a></li><li class="active"><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-lab3-KV-Service/" rel="bookmark" title="MIT6.824: lab3 KV Service">MIT6.824: lab3 KV Service</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Kalice" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Kalice</p><div class="description" itemprop="description">Life is not about lifestyle, it means Lithium and Ferrum.</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">67</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">16</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">38</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-Object-Storage-on-CRAQ-High-throughput-chain-replication-for-read-mostly-workloads/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/GrimoireLab%EF%BC%9A%E5%A1%AB%E5%9D%91%E8%AE%B0/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/js/" title="åˆ†ç±»äº è®°äº‹">è®°äº‹</a></div><span><a href="/2022/%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" title="å¯’å‡å­¦ä¹ è®¡åˆ’">å¯’å‡å­¦ä¹ è®¡åˆ’</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" title="åˆ†ç±»äº åˆ†å¸ƒå¼">åˆ†å¸ƒå¼</a></div><span><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-GFS/" title="MIT6.824: GFS">MIT6.824: GFS</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" title="åˆ†ç±»äº åˆ†å¸ƒå¼">åˆ†å¸ƒå¼</a></div><span><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-The-Design-of-a-Practical-System-for-Fault-Tolerant-Virtual-Machines/" title="MIT6.824: The Design of a Practical System for Fault-Tolerant Virtual Machines">MIT6.824: The Design of a Practical System for Fault-Tolerant Virtual Machines</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" title="åˆ†ç±»äº åˆ†å¸ƒå¼">åˆ†å¸ƒå¼</a></div><span><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824-zookeeper/" title="MIT6.824: ZooKeeper: Wait-free coordination for Internet-scale systems">MIT6.824: ZooKeeper: Wait-free coordination for Internet-scale systems</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Go/" title="åˆ†ç±»äº Go">Go</a></div><span><a href="/2022/Go/Golang-cookies%E4%B8%8Esessions/" title="Golang: cookiesä¸sessions">Golang: cookiesä¸sessions</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="åˆ†ç±»äº AI">AI</a></div><span><a href="/2021/%E8%AF%BB%E5%90%8E%E6%84%9F%EF%BC%9AAre-we-really-making-much-progress-Revisiting-benchmarking-and-refining-heterogeneous-graph-neural-networks/" title="è¯»åæ„Ÿï¼šAre we really making much progress? Revisiting, benchmarking, and refining  heterogeneous graph neural networks(è¯¦è§£)">è¯»åæ„Ÿï¼šAre we really making much progress? Revisiting, benchmarking, and refining heterogeneous graph neural networks(è¯¦è§£)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Go/" title="åˆ†ç±»äº Go">Go</a></div><span><a href="/2022/Go/golang-Web%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" title="golang Webç›¸å…³å­¦ä¹ ">golang Webç›¸å…³å­¦ä¹ </a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ss/" title="åˆ†ç±»äº çäº‹">çäº‹</a></div><span><a href="/2022/MongoDB-%E5%B8%B8%E7%94%A8%E7%AE%A1%E9%81%93%E5%87%BD%E6%95%B0/" title="MongoDB å¸¸ç”¨ç®¡é“å‡½æ•°">MongoDB å¸¸ç”¨ç®¡é“å‡½æ•°</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/LeetCode/" title="åˆ†ç±»äº LeetCode">LeetCode</a></div><span><a href="/2022/LeetCode/22-1-13%E5%88%B7%E9%A2%98/" title="22-1-13åˆ·é¢˜">22-1-13åˆ·é¢˜</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Go/" title="åˆ†ç±»äº Go">Go</a></div><span><a href="/2022/ss/git-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/" title="git å¸¸ç”¨æŒ‡ä»¤">git å¸¸ç”¨æŒ‡ä»¤</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 â€“ <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Kalice @ Songlin</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="ç«™ç‚¹æ€»å­—æ•°">145k å­—</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">2:12</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/åˆ†å¸ƒå¼/MIT6-824-lab3-KV-Service/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",hide:"(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,copy_tex:!0,katex:!0,mermaid:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->