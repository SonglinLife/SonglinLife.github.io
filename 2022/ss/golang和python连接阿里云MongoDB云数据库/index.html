<!-- build time:Wed May 11 2022 19:44:31 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Life" href="https://songlinlife.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="Life" href="https://songlinlife.top/atom.xml"><link rel="alternate" type="application/json" title="Life" href="https://songlinlife.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://songlinlife.top/2022/ss/golang%E5%92%8Cpython%E8%BF%9E%E6%8E%A5%E9%98%BF%E9%87%8C%E4%BA%91MongoDB%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93/"><title>golang和python连接阿里云MongoDB云数据库（解决ReplicaSetNoPrimary错误） - 琐事 | Songlin = Life</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">golang和python连接阿里云MongoDB云数据库（解决ReplicaSetNoPrimary错误）</h1><div class="meta"><span class="item" title="创建时间：2022-01-23 21:33:34"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-01-23T21:33:34+08:00">2022-01-23</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>5.4k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>5 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Songlin</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gicitspjpbj20zk0m81ky.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gicitzannuj20zk0m8b29.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipetv6p75j20zk0m8x6p.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipevarprfj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gicivghyooj20zk0m8dir.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipeu1usa7j20zk0m8b29.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ss/" itemprop="item" rel="index" title="分类于 琐事"><span itemprop="name">琐事</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://songlinlife.top/2022/ss/golang%E5%92%8Cpython%E8%BF%9E%E6%8E%A5%E9%98%BF%E9%87%8C%E4%BA%91MongoDB%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Kalice"><meta itemprop="description" content=", Life is not about lifestyle, it means Lithium and Ferrum."></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Life"></span><div class="body md" itemprop="articleBody"><p>最近一直被这个连接问题给困恼。。。怎么都没法连接上阿里云的云服务器。对于 golang 我用的是 <code>github.com/mongodb/mongo-go-driver</code> ，每一项都按照了文档去设置但是死活连接不上，于是更换为 <code>github.com/globalsign/mgo</code> ，这样就可以正常连接。对于 python，如果使用了 <code>pymongo4.0.1</code> 版本也是无法连接，但是更换为 <code>pymongo3.6</code> 就可以正常连接。</p><p>这两个现象都非常奇怪，但都有相同的特点，无论是 <code>golang</code> 里的 <code>mgo</code> 库还是 <code>python</code> 的 <code>pymong3.6</code> 都是挺老的版本。</p><h4 id="golang报错日志"><a class="anchor" href="#golang报错日志">#</a> golang 报错日志：</h4><p>2022/01/23 21:38:18 server selection error: server selection timeout, current topology: { Type: ReplicaSetNoPrimary, Servers: [{ Addr: 139.196.245.210:3717, Type: Unknown, Last error: connection() error occured during connection handshake: connection(139.196.245.210:3717[-127]) socket was unexpectedly closed: EOF }, { Addr: 139.196.245.214:3717, Type: Unknown, Last error: connection() error occured during connection handshake: connection(139.196.245.214:3717[-128]) socket was unexpectedly closed: EOF }, ] }</p><h4 id="python报错日志"><a class="anchor" href="#python报错日志">#</a> python 报错日志</h4><p>pymongo.errors.ServerSelectionTimeoutError: 139.196.245.214:3717: connection closed,139.196.245.210:3717: connection closed, Timeout: 30s, Topology Description: &lt;TopologyDescription id: 61ed5945eba641d6e1b58800, topology_type: ReplicaSetNoPrimary, servers: [&lt;ServerDescription ('139.196.245.210', 3717) server_type: Unknown, rtt: None, error=AutoReconnect('139.196.245.210:3717: connection closed')&gt;, &lt;ServerDescription ('139.196.245.214', 3717) server_type: Unknown, rtt: None, error=AutoReconnect('139.196.245.214:3717: connection closed')&gt;]&gt;</p><p>看到这个错误日志真的令人迷惑，为啥会出现这么多的 server，我只是通过跳板机访问了一个服务。</p><p>查找资料后发现，这些云数据库都是容器化管理，也就是我的一台 mongodb 云数据库，其实有多个容器组成的集群，这些容器之间可以相互访问，但是外部无法访问集群的节点。</p><p>这里非常感谢，<span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8xNWRkZjU5NWE2Y2M=">连接 Replica Set 出现问题</span>给出了解释：</p><blockquote><p>MongoDB driver will attempt <code>server discovery</code> from given a replica set member(s); it will find all of other nodes within the replica set (via <span class="exturl" data-url="aHR0cHM6Ly9saW5rcy5qaWFuc2h1LmNvbS9nbz90bz1odHRwcyUzQSUyRiUyRmRvY3MubW9uZ29kYi5jb20lMkZtYW51YWwlMkZyZWZlcmVuY2UlMkZtZXRob2QlMkZycy5jb25mJTJG">rs.conf</span>). The problem here is the replica set is set with name <code>mongo&lt;N&gt;</code> , the driver (run in Docker host) would not be able to resolve these names. You can confirm this by trying to ping <code>mongo1</code> from Docker host.</p><p>You can either try running the application from another Docker instance sharing the same Docker network as the replica set. Or, modify the Docker networking as such to allow resolvable hostnames.</p><p>UPDATE:</p><p>Regarding your comment on why using <span class="exturl" data-url="aHR0cHM6Ly9saW5rcy5qaWFuc2h1LmNvbS9nbz90bz1odHRwcyUzQSUyRiUyRmRvY3MubW9uZ29kYi5jb20lMkZtYW51YWwlMkZtb25nbyUyRg==">mongo</span> shell, or <span class="exturl" data-url="aHR0cHM6Ly9saW5rcy5qaWFuc2h1LmNvbS9nbz90bz1odHRwcyUzQSUyRiUyRmFwaS5tb25nb2RiLmNvbSUyRnB5dGhvbiUyRmN1cnJlbnQlMkY=">PyMongo</span> works.</p><p>This is due to the difference in connection mode. When specifying a single node, i.e. <code>mongodb://node1:27017</code> in shell or PyMongo, server discovery are not being made. Instead it will attempt to connect to that single node (not as part as a replica set). The catch is that you need to connect to the primary node of the replica set to write (you have to know which one). If you would like to connect as a replica set, you have to define the replica set name.</p><p>In contrast to the <code>mongo-go-driver</code> , by default it would perform server discovery and attempt to connect as a replica set. If you would like to connect as a single node, then you need to specify <code>connect=direct</code> in the connection URI.</p></blockquote><p>也就是说 driver 会默认开启 <code>服务发现</code> ，这就导致我们会从容器的外部来访问这个集群的其他机器。</p><p>在 <code>pymongo</code> 和 <code>mgo</code> 这些比较旧的服务器里，因为那时还没有流行这种集群化管理，所以没有服务发现的功能。</p><h3 id="解决办法"><a class="anchor" href="#解决办法">#</a> 解决办法</h3><blockquote><p>In contrast to the <code>mongo-go-driver</code> , by default it would perform server discovery and attempt to connect as a replica set. If you would like to connect as a single node, then you need to specify <code>connect=direct</code> in the connection URI.</p></blockquote><p>采用 <code>direct</code> 的连接方式。</p><p>这里可以看 <code>golang</code> 给出的 <code>docs</code> ：</p><figure class="highlight go"><figcaption data-lang="go"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> main</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token string">"context"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token string">"log"</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token string">"go.mongodb.org/mongo-driver/mongo"</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token string">"go.mongodb.org/mongo-driver/mongo/options"</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token comment">// Create a direct connection to a host. The driver will send all requests</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token comment">// to that host and will not automatically discover other hosts in the</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token comment">// deployment.</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>	clientOpts <span class="token operator">:=</span> options<span class="token punctuation">.</span><span class="token function">Client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ApplyURI</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="17"></td><td><pre>		<span class="token string">"mongodb://localhost:27017/?connect=direct"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	client<span class="token punctuation">,</span> err <span class="token operator">:=</span> mongo<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> clientOpts<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	<span class="token boolean">_</span> <span class="token operator">=</span> client</pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><code>ApplyURI</code> 把 <code>connect=direct</code> 加入，这样就可以愉快连接了。</p><h4 id="pymongo"><a class="anchor" href="#pymongo">#</a> pymongo</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>client <span class="token operator">=</span> MongoClient<span class="token punctuation">(</span><span class="token string">'mongodb://localhost'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="2"></td><td><pre>                     port<span class="token operator">=</span><span class="token number">3733</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>                     username<span class="token operator">=</span>username<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>                     password<span class="token operator">=</span>password<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>                     authSource<span class="token operator">=</span><span class="token string">'admin'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>                     directConnection <span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                     authMechanism<span class="token operator">=</span><span class="token string">'SCRAM-SHA-1'</span></pre></td></tr><tr><td data-num="8"></td><td><pre>                     <span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>pymongo</code> 中有个字段 <code>directConnection</code> ，这个字段设置为 <code>True</code> 代表直接连接。</p><h3 id="这里附上我连接的代码"><a class="anchor" href="#这里附上我连接的代码">#</a> 这里附上我连接的代码</h3><h4 id="golang"><a class="anchor" href="#golang">#</a> golang</h4><figure class="highlight go"><figcaption data-lang="go"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> main</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token string">"context"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token string">"log"</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token string">"os"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token string">"time"</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token string">"github.com/elliotchance/sshtunnel"</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token string">"go.mongodb.org/mongo-driver/mongo"</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token string">"go.mongodb.org/mongo-driver/mongo/options"</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token string">"golang.org/x/crypto/ssh"</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	tunnel <span class="token operator">:=</span> sshtunnel<span class="token punctuation">.</span><span class="token function">NewSSHTunnel</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="17"></td><td><pre>		<span class="token comment">// 在这里设置你的跳板机地址.</span></pre></td></tr><tr><td data-num="18"></td><td><pre>		<span class="token string">"username@ipv4:port"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>		</pre></td></tr><tr><td data-num="20"></td><td><pre>		<span class="token comment">// 选择 sshpassword 的连接方式</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		ssh<span class="token punctuation">.</span><span class="token function">Password</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>		<span class="token comment">// 阿里云 mongodb 的地址.</span></pre></td></tr><tr><td data-num="24"></td><td><pre>		<span class="token string">"dds-uf61fd4**********44-pub.mongodb.rds.aliyuncs.com:3717"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>		<span class="token comment">// 设置本地绑定端口</span></pre></td></tr><tr><td data-num="27"></td><td><pre>		<span class="token string">"3733"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	tunnel<span class="token punctuation">.</span>Log <span class="token operator">=</span> log<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> log<span class="token punctuation">.</span>Ldate<span class="token operator">|</span>log<span class="token punctuation">.</span>Lmicroseconds<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	<span class="token keyword">go</span> tunnel<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Millisecond<span class="token punctuation">)</span> <span class="token comment">// 等待开启 tunnel</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	<span class="token function">MgoCli</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">var</span> mgoCli <span class="token operator">*</span>mongo<span class="token punctuation">.</span>Client</pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">func</span> <span class="token function">initDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>	<span class="token keyword">var</span> err <span class="token builtin">error</span></pre></td></tr><tr><td data-num="39"></td><td><pre>	credential <span class="token operator">:=</span> options<span class="token punctuation">.</span>Credential<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>		AuthMechanism<span class="token punctuation">:</span> <span class="token string">"SCRAM-SHA-1"</span><span class="token punctuation">,</span> <span class="token comment">// 阿里云服务的</span></pre></td></tr><tr><td data-num="41"></td><td><pre>		Username<span class="token punctuation">:</span>      <span class="token string">"username"</span><span class="token punctuation">,</span> <span class="token comment">//mongodb 用户名</span></pre></td></tr><tr><td data-num="42"></td><td><pre>		Password<span class="token punctuation">:</span>      <span class="token string">"password"</span><span class="token punctuation">,</span> <span class="token comment">//mongodb 密码</span></pre></td></tr><tr><td data-num="43"></td><td><pre>		AuthSource<span class="token punctuation">:</span>    <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token comment">// 默认 admin 不需要改</span></pre></td></tr><tr><td data-num="44"></td><td><pre>		PasswordSet<span class="token punctuation">:</span>   <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="45"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>	clientOpts <span class="token operator">:=</span> options<span class="token punctuation">.</span><span class="token function">Client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ApplyURI</span><span class="token punctuation">(</span><span class="token string">"mongodb://localhost:3733"</span><span class="token punctuation">)</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="48"></td><td><pre>		<span class="token function">SetAuth</span><span class="token punctuation">(</span>credential<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>	<span class="token comment">// 连接到 MongoDB</span></pre></td></tr><tr><td data-num="50"></td><td><pre>	ctx<span class="token punctuation">,</span> cancel <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithTimeout</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">*</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span> <span class="token comment">// 设置 5s 超时</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token keyword">defer</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    </pre></td></tr><tr><td data-num="53"></td><td><pre>	client<span class="token punctuation">,</span> err <span class="token operator">:=</span> mongo<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> clientOpts<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>	<span class="token comment">// 检查连接</span></pre></td></tr><tr><td data-num="58"></td><td><pre>	err <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">Ping</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre>	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token keyword">func</span> <span class="token function">MgoCli</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>mongo<span class="token punctuation">.</span>Client <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>	<span class="token keyword">if</span> mgoCli <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>		<span class="token function">initDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="66"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>	<span class="token keyword">return</span> mgoCli</pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id="pymongo-2"><a class="anchor" href="#pymongo-2">#</a> pymongo</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> pymongo <span class="token keyword">import</span> MongoClient</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> sshtunnel <span class="token keyword">import</span> SSHTunnelForwarder</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> pprint <span class="token keyword">import</span> pprint</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="6"></td><td><pre>tunnel <span class="token operator">=</span> SSHTunnelForwarder<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                        <span class="token punctuation">(</span><span class="token string">"跳板机ip"</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>                        ssh_username<span class="token operator">=</span><span class="token string">r"跳板机用户名"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>                        ssh_password<span class="token operator">=</span><span class="token string">r"跳板机密码"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>                        remote_bind_address<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">r"dds-uf61f**********b.mongodb.rds.aliyuncs.com"</span><span class="token punctuation">,</span> <span class="token number">3717</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>                        local_bind_address<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token number">3733</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>tunnel<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>tunnel<span class="token punctuation">.</span>local_bind_port<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">from</span> pymongo <span class="token keyword">import</span> MongoClient</pre></td></tr><tr><td data-num="15"></td><td><pre>client <span class="token operator">=</span> MongoClient<span class="token punctuation">(</span><span class="token string">'mongodb://localhost'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                     port<span class="token operator">=</span><span class="token number">3733</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                     username<span class="token operator">=</span><span class="token string">'数据库用户名'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                     password<span class="token operator">=</span><span class="token string">'数据库密码'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                     authSource<span class="token operator">=</span><span class="token string">'admin'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                     directConnection <span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token comment"># 使用直接连接方式</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                     authMechanism<span class="token operator">=</span><span class="token string">'SCRAM-SHA-256'</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                     <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>db <span class="token operator">=</span> client<span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="24"></td><td><pre>npm <span class="token operator">=</span> db<span class="token punctuation">[</span><span class="token string">'npm_records'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">for</span> item <span class="token keyword">in</span> npm<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>limit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    pprint<span class="token punctuation">(</span>item<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="27"></td><td><pre>tunnel<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-05-11 19:42:45" itemprop="dateModified" datetime="2022-05-11T19:42:45+08:00">2022-05-11</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Kalice 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Kalice 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Kalice <i class="ic i-at"><em>@</em></i>Life</li><li class="link"><strong>本文链接：</strong> <a href="https://songlinlife.top/2022/ss/golang%E5%92%8Cpython%E8%BF%9E%E6%8E%A5%E9%98%BF%E9%87%8C%E4%BA%91MongoDB%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93/" title="golang和python连接阿里云MongoDB云数据库（解决ReplicaSetNoPrimary错误）">https://songlinlife.top/2022/ss/golang和python连接阿里云MongoDB云数据库/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/Go/Golang-%E5%86%99%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclj61ylzj20zk0m8b29.jpg" title="Golang: 写正则表达式"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Go</span><h3>Golang: 写正则表达式</h3></a></div><div class="item right"><a href="/2022/MongoDB-%E5%B8%B8%E7%94%A8%E7%AE%A1%E9%81%93%E5%87%BD%E6%95%B0/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclj9410cj20zk0m8h12.jpg" title="MongoDB 常用管道函数"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 琐事</span><h3>MongoDB 常用管道函数</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#golang%E6%8A%A5%E9%94%99%E6%97%A5%E5%BF%97"><span class="toc-number">1.</span> <span class="toc-text">golang 报错日志：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#python%E6%8A%A5%E9%94%99%E6%97%A5%E5%BF%97"><span class="toc-number">2.</span> <span class="toc-text">python 报错日志</span></a></li></ol><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95"><span class="toc-number"></span> <span class="toc-text">解决办法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pymongo"><span class="toc-number">1.</span> <span class="toc-text">pymongo</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E9%87%8C%E9%99%84%E4%B8%8A%E6%88%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-number"></span> <span class="toc-text">这里附上我连接的代码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#golang"><span class="toc-number">1.</span> <span class="toc-text">golang</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pymongo-2"><span class="toc-number">2.</span> <span class="toc-text">pymongo</span></a></li></ol></li></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2021/ss/Linux%E5%BC%80%E5%90%AF%E4%BB%A3%E7%90%86/" rel="bookmark" title="linux 开启代理">linux 开启代理</a></li><li><a href="/2021/ss/zsh%E7%BE%8E%E5%8C%96/" rel="bookmark" title="zsh美化">zsh美化</a></li><li><a href="/2021/ss/vscode-%E8%BF%9C%E7%A8%8B%E7%BB%88%E7%AB%AF%E4%B8%8D%E8%83%BD%E6%89%93%E5%BC%80zsh/" rel="bookmark" title="vscode 远程终端不能打开zsh">vscode 远程终端不能打开zsh</a></li><li><a href="/2021/ss/VScode-%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95%E5%85%8D%E5%AF%86%E7%A0%81/" rel="bookmark" title="VScode 远程登录免密码">VScode 远程登录免密码</a></li><li><a href="/2022/Mysql-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/" rel="bookmark" title="Mysql 常用指令">Mysql 常用指令</a></li><li><a href="/2022/ss/%E4%BD%BF%E7%94%A8%E8%85%BE%E8%AE%AF%E8%BD%BB%E9%87%8F%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8Efrp%E5%BC%80%E5%90%AF%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" rel="bookmark" title="10分钟使用腾讯轻量应用服务器与frp开启内网穿透实现ssh">10分钟使用腾讯轻量应用服务器与frp开启内网穿透实现ssh</a></li><li class="active"><a href="/2022/ss/golang%E5%92%8Cpython%E8%BF%9E%E6%8E%A5%E9%98%BF%E9%87%8C%E4%BA%91MongoDB%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="bookmark" title="golang和python连接阿里云MongoDB云数据库（解决ReplicaSetNoPrimary错误）">golang和python连接阿里云MongoDB云数据库（解决ReplicaSetNoPrimary错误）</a></li><li><a href="/2022/MongoDB-%E5%B8%B8%E7%94%A8%E7%AE%A1%E9%81%93%E5%87%BD%E6%95%B0/" rel="bookmark" title="MongoDB 常用管道函数">MongoDB 常用管道函数</a></li><li><a href="/2022/ss/HTML%EF%BC%9A%E5%AD%A6%E4%B9%A0/" rel="bookmark" title="HTML与CSS学习">HTML与CSS学习</a></li><li><a href="/2022/ss/%E6%96%B0%E6%97%B6%E4%BB%A3/" rel="bookmark" title="新时代">新时代</a></li><li><a href="/2022/ss/Git-%E4%BB%A3%E7%90%86/" rel="bookmark" title="Git 代理">Git 代理</a></li><li><a href="/2022/ss/tmux%E7%94%A8%E6%B3%95/" rel="bookmark" title="tmux用法">tmux用法</a></li><li><a href="/2022/vim/nvim%E5%AD%A6%E4%B9%A0/" rel="bookmark" title="主题和vim">主题和vim</a></li><li><a href="/2022/PPT%E5%AD%A6%E4%B9%A0/" rel="bookmark" title="PPT学习">PPT学习</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Kalice" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Kalice</p><div class="description" itemprop="description">Life is not about lifestyle, it means Lithium and Ferrum.</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">112</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">20</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">42</span> <span class="name">标签</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/Go/Golang-%E5%86%99%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/MongoDB-%E5%B8%B8%E7%94%A8%E7%AE%A1%E9%81%93%E5%87%BD%E6%95%B0/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Go/" title="分类于 Go">Go</a></div><span><a href="/2022/Go/Golang-%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6/" title="Golang: 读写文件">Golang: 读写文件</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="分类于 AI">AI</a></div><span><a href="/2021/ai/DGL-02-%E6%9E%84%E5%BB%BA%E5%9B%BE%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" title="DGL(02): 构建图神经网络">DGL(02): 构建图神经网络</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ss/" title="分类于 琐事">琐事</a></div><span><a href="/2022/ss/golang%E5%92%8Cpython%E8%BF%9E%E6%8E%A5%E9%98%BF%E9%87%8C%E4%BA%91MongoDB%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93/" title="golang和python连接阿里云MongoDB云数据库（解决ReplicaSetNoPrimary错误）">golang和python连接阿里云MongoDB云数据库（解决ReplicaSetNoPrimary错误）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Go/" title="分类于 Go">Go</a></div><span><a href="/2022/Go/Golang%EF%BC%9A%E6%9F%A5%E8%AF%A2MongoDB/" title="Golang：查询MongoDB">Golang：查询MongoDB</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ss/" title="分类于 琐事">琐事</a></div><span><a href="/2022/ss/%E6%96%B0%E6%97%B6%E4%BB%A3/" title="新时代">新时代</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" title="分类于 分布式">分布式</a></div><span><a href="/2022/%E5%88%86%E5%B8%83%E5%BC%8F/MIT6-824%EF%BC%9ASpaner/" title="MIT6.824：Spaner">MIT6.824：Spaner</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/js/" title="分类于 记事">记事</a></div><span><a href="/2022/js/%E5%AF%92%E5%81%87%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" title="寒假学习计划">寒假学习计划</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ai/" title="分类于 AI">AI</a></div><span><a href="/2021/ai/DGL-03-%E5%9B%BE%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E7%AE%A1%E9%81%93/" title="DGL(03): 图数据处理管道">DGL(03): 图数据处理管道</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Go/" title="分类于 Go">Go</a></div><span><a href="/2022/ss/git-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/" title="git 常用指令">git 常用指令</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/golang/" title="分类于 golang">golang</a></div><span><a href="/2022/Go/golang%E5%AE%9E%E7%8E%B0%E5%90%84%E7%A7%8D%E6%8E%92%E5%BA%8F/" title="golang实现各种排序">golang实现各种排序</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Kalice @ Songlin</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">224k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">3:24</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/ss/golang和python连接阿里云MongoDB云数据库/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,mermaid:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->